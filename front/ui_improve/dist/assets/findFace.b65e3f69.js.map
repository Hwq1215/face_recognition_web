{"version":3,"file":"findFace.b65e3f69.js","sources":["../../src/myViews/findFace.vue"],"sourcesContent":["<template>\r\n\r\n        <div class=\"top-box\">\r\n    <h4>\r\n        开启欺诈识别<el-switch v-model=\"isOpenFAS\"></el-switch>\r\n    </h4>\r\n    <h4>\r\n        开启关键点标识<el-switch v-model=\"isOpenLandmarks\"></el-switch>\r\n    </h4>\r\n        <!-- <el-button type=\"success\" size=\"large\" class=\"top-button\" @click=\"slice\">asd</el-button> -->\r\n    <el-button type=\"success\"  class=\"top-button\" @click=\"handleRecord()\">录制 <el-icon><VideoCamera /></el-icon></el-button>\r\n</div>\r\n<div>\r\n\r\n    <el-upload\r\n      class=\"upload-demo\"\r\n      :action=\"actionUrl\"\r\n      drag=\"true\"\r\n      ref=\"upload-ref\"\r\n      auto-upload=\"true\"\r\n      :http-request=\"httpRequest\"\r\n      :on-preview=\"handlePreview\"\r\n      v-model:file-list=\"fileList2\"\r\n      list-type=\"picture\">\r\n      <el class=\"drag-item\">\r\n        <h3>拖拽图片到这</h3>\r\n        <h5>- 或 -</h5>\r\n        <h3>点此上传</h3></el>\r\n    <el-dialog v-model=\"dialogIsVisible\"  :append-to-body=\"true\" :close-on-click-modal=\"false\" :lock-scroll=\"true\" class=\"img-dialog\">\r\n        <div class=\"img-block\">\r\n            <img w-full  :src=\"previewContent.imgUrl\">\r\n                <span>识别结果由从左到右排序，分别为</span>\r\n                <div v-for=\"item in previewContent.names\">\r\n                    <span>{{item}},</span>\r\n                </div>\r\n        </div>\r\n        \r\n    </el-dialog>\r\n    </el-upload>\r\n\r\n    <!-- <div class=\"side-box\">\r\n        <el-button>\r\n        <el-icon><Plus /></el-icon>\r\n        </el-button>\r\n    </div> -->\r\n</div>\r\n\r\n<el-dialog v-model=\"VideoDialogIsVisiable\">\r\n    <video-reader @choose-img=\"uploadImg()\" ref=\"video-reader\">\r\n        <!-- <template #second-btn>\r\n            <el-button type=\"warning\" @click=\"\">查看</el-button>\r\n        </template> -->\r\n    </video-reader>\r\n</el-dialog>\r\n    </template>\r\n<script lang=\"js\">\r\nimport axios from 'axios'\r\nimport { Plus } from '@element-plus/icons-vue'\r\nimport { httpurl } from '../config'\r\nimport VideoReader from '../mycomponents/VideoReader.vue'\r\n\r\nexport default {\r\n    data(){\r\n        return {\r\n        fileList2: [],\r\n        actionUrl: httpurl+\"/findface\",\r\n        produce_result: {},\r\n        dialogIsVisible: false,\r\n        isOpenFAS: true,\r\n        isOpenLandmarks: true,\r\n        VideoDialogIsVisiable: false,\r\n     }\r\n    },\r\n    computed: {\r\n        previewContent(){\r\n            return {\r\n               \"imgUrl\":this.produce_result.imgUrl,\r\n               \"names\": this.produce_result.names.map((item)=>{\r\n                    return item == 'unknown' ? '未知' : item;\r\n               })\r\n            }\r\n        },\r\n    },\r\n    components:{\r\n        VideoReader,\r\n        Plus,\r\n    },\r\n    methods: {\r\n        handleRemove(file, fileList) {\r\n        console.log(file);\r\n        console.log(this.fileList2);\r\n        },\r\n        handlePreview(file) {\r\n        console.log(file);\r\n        this.produce_result = file.response.data;\r\n        this.dialogIsVisible = true;\r\n        },\r\n\r\n        async httpRequest(options){\r\n        console.log(options)\r\n        let fd = new FormData();\r\n        fd.append('imgfile', options.file);\r\n        var ax = axios({\r\n            method:'post',\r\n            url:options.action+\"?isopenfas=\"+this.isOpenFAS+\"&isopenlandmarks=\"+this.isOpenLandmarks,\r\n            headers:{'Content-Type':'multipart/form-data',\r\n                    \"Access-Control-Allow-Origin\": \"*\"},\r\n            data:fd,\r\n        }) \r\n        return ax;\r\n        },\r\n        handleRecord(){\r\n            this.VideoDialogIsVisiable = true;\r\n        },\r\n        async uploadImg(){\r\n            var imgUrl = this.$refs['video-reader'].imgUrl;\r\n            var img = this.$refs['video-reader'].imgFile;\r\n            if(imgUrl == '' || imgUrl == null || imgUrl == undefined){\r\n                this.$message.error('请先拍照');\r\n                return;\r\n            }\r\n            if(img == '' || img == null || img == undefined){\r\n                this.$message.error('请先拍照');\r\n                return;\r\n            }\r\n            console.log(img);\r\n            let fd = new FormData();\r\n            fd.append('imgfile',img);\r\n            var ax = axios({\r\n            method:'post',\r\n            url:this.actionUrl+\"?isopenfas=\"+this.isOpenFAS+\"&isopenlandmarks=\"+this.isOpenLandmarks,\r\n            headers:{'Content-Type':'multipart/form-data',\r\n                    \"Access-Control-Allow-Origin\": \"*\"},\r\n            data:fd,\r\n            })\r\n            this.fileList2.push({\r\n                name: \"cut.png\",\r\n                percentage: 0,\r\n                status: 'success',\r\n                size: img.size,\r\n                uid: 0,\r\n                url: imgUrl,\r\n                response: {\r\n                    data: await ax.then(res => res.data),\r\n                },\r\n                raw: new File([img],'cut_img', {type:'image/png', lastModified: Date.now()})\r\n            });\r\n            this.VideoDialogIsVisiable = false;\r\n        },\r\n    }\r\n    }\r\n</script>\r\n\r\n<style>\r\n    .drag-item{\r\n        font-size: medium;\r\n        background-color: #f5f7fa;\r\n    }\r\n    .top-box{\r\n        width: 100%;\r\n        height: 100%;   \r\n        display: flex;\r\n        background-color: #ffffff;\r\n        font-size: large;\r\n        align-items: center;\r\n    }\r\n    .top-box h4{\r\n        margin-left: 3%;\r\n    }\r\n    .top-box .top-button{\r\n        margin-left: 5%;\r\n    }\r\n    .father-box{\r\n        width: 100%;\r\n        height: 100%;\r\n        display: flex;\r\n    }\r\n    .record-button{\r\n        width: 100px;\r\n    }\r\n    .upload-demo{\r\n        width: 100%;\r\n        height: 100%;\r\n        margin-bottom: 300px;\r\n    }\r\n    .img-dialog{\r\n        height: auto;\r\n        width: 100%;\r\n        text-align: center;\r\n        align-items: center;\r\n        justify-content: center;\r\n    }\r\n    .img-dialog .img-block{\r\n        text-align: center;\r\n        align-items: center;\r\n        justify-content: center;\r\n    }\r\n    .img-block img{\r\n        max-width: 350px;\r\n        max-height: 350px;\r\n        margin: 0 auto;\r\n    }\r\n\r\n    ::v-deep .el-dialog{\r\n       display: flex;\r\n       flex-direction: column;\r\n       margin:0 !important;\r\n       position:absolute;\r\n       top:50%;\r\n       left:50%;\r\n       transform:translate(-50%,-50%);\r\n       max-height:calc(100% - 30px);\r\n       max-width:calc(100% - 30px);\r\n   }\r\n  ::v-deep  .el-dialog .el-dialog__body{\r\n       flex:1;\r\n       overflow: auto;\r\n   }\r\n</style>"],"names":[],"mappings":"6dA6DA"}
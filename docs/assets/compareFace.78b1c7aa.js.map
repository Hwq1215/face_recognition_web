{"version":3,"file":"compareFace.78b1c7aa.js","sources":["../../src/myViews/compareFace.vue"],"sourcesContent":["<template>\r\n    <div class=\"w-full\">\r\n        <div class=\"compare-box\">\r\n        <div class=\"left-img-container\">\r\n            \r\n            <h3>第一张图片</h3>\r\n            <el-upload class=\"img-button\"\r\n            ref=\"upload\"\r\n            :action=\"actionUrl\"\r\n            drag\r\n            v-model:file-list=\"fileList1\"\r\n            list-type=\"picture-card\"\r\n            :show-file-list=\"false\"\r\n            :limit=\"1\"\r\n            :auto-upload=\"false\"\r\n            >      \r\n            <div v-if=\"img1Url\" >          \r\n                <img  v-if=\"img1Url\" class=\"imgshow\" :src=\"img1Url\">\r\n            </div>\r\n                <el-icon v-else class=\"avatar-uploader-icon \"><IconPicture /></el-icon>\r\n            </el-upload>\r\n            <div class=\"record-button\">\r\n                <el-button type=\"success\" @click=\"openVideo(1)\" round><el-icon><CameraIcon /></el-icon></el-button>\r\n            </div>\r\n        </div>\r\n        \r\n        <div class=\"mid-img-container\">\r\n            <div>\r\n\r\n            </div>\r\n            <div>\r\n                <el-button type=\"primary\" size=\"large\" @click=\"compare\">比对</el-button>\r\n            </div>\r\n            <div>\r\n                <el-button type=\"danger\" size=\"large\" @click=\"clear\">清空</el-button>\r\n            </div>\r\n        </div>\r\n         <div class=\"right-img-container\">\r\n            <h3>第二张图片</h3>\r\n            <el-upload class=\"img-button\"\r\n            ref=\"upload\"\r\n            list-type=\"picture-card\"\r\n            :action=\"actionUrl\"\r\n            drag\r\n            v-model:file-list=\"fileList2\"\r\n            :show-file-list=\"false\"\r\n            :limit=\"1\"\r\n            :auto-upload=\"false\"\r\n            >\r\n            <div  v-if=\"img2Url\" class=\"imgshow\">\r\n                <img  v-if=\"img1Url\" :src=\"img2Url\">\r\n            </div>\r\n                <el-icon v-else class=\"avatar-uploader-icon \"><IconPicture /></el-icon>\r\n            </el-upload>\r\n            <div class=\"record-button\">\r\n                <el-button type=\"success\" @click=\"openVideo(2)\" round><el-icon><CameraIcon /></el-icon></el-button>\r\n            </div>\r\n        </div>\r\n\r\n    </div>\r\n \r\n    </div>\r\n    <el-dialog v-model=\"DialogIsVisiable\" v-loading=\"loadingVisible\" width=\"200px\" title=\"比对结果\" center>\r\n            <div>\r\n                <div >\r\n                    <div >\r\n                    <h3>是否为一个人\r\n                        <el-icon v-if=\"loadingVisible\"> <Loading /></el-icon>\r\n                        <el-icon v-else-if=\"result.is_same\"  color=\"#5bc194\"><SuccessFilled/></el-icon>\r\n                        <el-icon v-else color=\"#fc5531\"><CircleCloseFilled/></el-icon>\r\n                    </h3>\r\n                    </div>\r\n                    <div>\r\n                    <h3>成绩:\r\n                        <el-icon v-if=\"loadingVisible\"> <Loading /></el-icon>\r\n                        <el v-else>{{result.score}}</el>\r\n                    </h3>\r\n                    </div>\r\n                </div>\r\n                \r\n            </div>\r\n    </el-dialog>\r\n\r\n    <el-dialog v-model=\"VideoDialogIsVisiable\" class=\"dialog-center\" :lock-scroll=\"false\">\r\n        <video-reader @choose-img=\"saveImg()\" ref=\"video-reader\"></video-reader>\r\n    </el-dialog>\r\n\r\n</template>\r\n\r\n<script >\r\nimport { Picture as IconPicture ,SuccessFilled,CircleCloseFilled,Loading} from '@element-plus/icons-vue'\r\nimport { httpurl } from '../config';\r\nimport axios from 'axios';\r\nimport VideoReader from '../mycomponents/VideoReader.vue';\r\nimport {CameraIcon} from '@heroicons/vue/solid'\r\nexport default{\r\n    name: 'compareFace',\r\n    data(){\r\n        return{\r\n            fileList1:[],\r\n            fileList2:[],\r\n            result: {\r\n                is_same: false,\r\n                score: 0,\r\n            },\r\n            actionUrl: httpurl+\"/compare\",\r\n            img1Url: '',\r\n            img2Url: '',\r\n            DialogIsVisiable: false,\r\n            loadingVisible: true,\r\n            VideoDialogIsVisiable: false,\r\n            videoIndex: 1,\r\n        }\r\n    },\r\n    watch:{\r\n        fileList1(newVal){\r\n            if(newVal.length>0){\r\n                this.img1Url = URL.createObjectURL(newVal[0].raw);\r\n            }\r\n        },\r\n        fileList2(newVal){\r\n            if(newVal.length>0){\r\n                this.img2Url = URL.createObjectURL(newVal[0].raw);\r\n            }\r\n        }\r\n    },\r\n    components: {\r\n        IconPicture,\r\n        SuccessFilled,\r\n        CircleCloseFilled,\r\n        Loading,\r\n        VideoReader,\r\n        CameraIcon,\r\n    },\r\n    methods:{\r\n        compare(){\r\n            this,this.loadingVisible = true;\r\n            this.DialogIsVisiable = true;\r\n            let fd = new FormData();\r\n            console.log(this.fileList1);\r\n            console.log(this.fileList2);\r\n            if (this.fileList1.length == 0 || this.fileList2.length == 0){\r\n                this.$message.error('请上传图片');\r\n                return;\r\n            }\r\n            fd.append('img1', this.fileList1[0].raw);\r\n            fd.append('img2', this.fileList2[0].raw);\r\n            axios({\r\n                method:'post',\r\n                url:this.actionUrl,\r\n                headers:{'Content-Type':'multipart/form-data',\r\n                        \"Access-Control-Allow-Origin\": \"*\"},\r\n                data:fd,\r\n            }).then((res)=>{\r\n                console.log(res);\r\n                this.result = res.data;\r\n                if(res.status!=200){\r\n                    this.$message.error('比对失败');\r\n                    this.DialogIsVisiable = false\r\n                    return;\r\n                }\r\n                console.log(this.result);\r\n                if(this.result.score == -1){\r\n                    this.$message.error('比对失败,没有找到人脸');\r\n                    this.DialogIsVisiable = false\r\n                    return;\r\n                }\r\n                \r\n                this.loadingVisible = false;                \r\n            })\r\n        },\r\n        clear(){\r\n            this.fileList1 = [];\r\n            this.fileList2 = [];\r\n            this.img1Url = '';\r\n            this.img2Url = '';\r\n        },\r\n        openVideo(index){\r\n            console.log(index);\r\n            this.videoIndex = index;\r\n            this.VideoDialogIsVisiable = true;\r\n        },\r\n        saveImg(){\r\n            var img = this.$refs['video-reader'].imgFile;\r\n            if(img == '' || img == null || img == undefined){\r\n                this.$message.error('请先拍照');\r\n                return;\r\n            }\r\n            if(this.videoIndex == 1){\r\n                this.fileList1 = [];\r\n                this.fileList1.push({raw:img});\r\n            }else{\r\n                this.fileList2 = [];\r\n                this.fileList2.push({raw:img});\r\n            }\r\n            this.VideoDialogIsVisiable = false;\r\n        }\r\n    }\r\n}\r\n</script>\r\n<style>\r\n@media screen and (max-width: 1400px) {\r\n    .compare-box{\r\n    width: 100%;\r\n    height: 1300px;\r\n    background-color: #f8f9fe;\r\n    text-align: center;\r\n    align-items: center;\r\n    justify-content: center;\r\n}\r\n\r\n.left-img-container{\r\n    margin: 0 auto;\r\n    margin-top: 20%;\r\n    width: 400px;\r\n    height: 400px;\r\n    background-color: #f8f9fe;\r\n    text-align: center;\r\n}\r\n\r\n.left-img-container .el-upload-dragger{\r\n    width: 400px;\r\n    height: 400px;\r\n    background-color: #f8f9fe;\r\n    border: #614555 2px;\r\n    border-radius: 5px;\r\n    border-style:dotted;\r\n    text-align: center;\r\n}\r\n\r\n.right-img-container{\r\n    margin: 0 auto;\r\n    margin-top: 5%;\r\n    width: 400px;\r\n    height: 400px;\r\n    background-color: #f8f9fe;\r\n    text-align: center;\r\n    \r\n}\r\n\r\n.right-img-container .el-upload-dragger{\r\n    width: 400px;\r\n    height: 400px;\r\n    background-color: #f8f9fe;\r\n    border: #614555 2px;\r\n    border-radius: 5px;\r\n    border-style:dotted;\r\n    text-align: center;\r\n}\r\n\r\n .mid-img-container{\r\n    margin-top: 50px;\r\n    background-color: #f8f9fe;\r\n    border: #f5f5f5 1px;\r\n    border-radius: 5px;\r\n    text-align: center;\r\n    align-items: center;\r\n    justify-content: center;\r\n}\r\n\r\n.mid-img-container > div{\r\n    width: 100%;\r\n    height: 100px;\r\n    background-color: #f8f9fe;\r\n    text-align: center;\r\n}\r\n\r\n.img-button{\r\n    width: 100%;\r\n    height: 100%;\r\n    background-color: #f8f9fe;\r\n    border: #f5f5f5 1px;\r\n    border-radius: 5px;\r\n    display: flex;\r\n    text-align: center;\r\n}\r\n.img-button .imgshow{\r\n    max-width: 400px;\r\n    max-height: 400px;\r\n    margin: 0 auto;\r\n    justify-content: center;\r\n    align-items: center;\r\n}\r\n.imgshow img{\r\n    max-width: 400px;\r\n    max-height: 400px;\r\n    display: inline;\r\n    object-fit: fill;\r\n    margin: 0 auto;\r\n}\r\n.el-icon.avatar-uploader-icon {\r\n  font-size: 28px;\r\n  color: #8c939d;\r\n  width: 300px;\r\n  height: 300px;\r\n  text-align: center;\r\n}\r\n.dialog-center{\r\n    text-align: center;\r\n}\r\n.record-button{\r\n    margin-top: 5%;\r\n    width: 100%;\r\n    height: 100%;\r\n}\r\n}\r\n@media screen and (min-width: 1400px) {\r\n    .compare-box{\r\n    display: flex;\r\n    width: 100%;\r\n    height: 100%;\r\n    background-color: #ffffff;\r\n    text-align: center;\r\n    align-items: center;\r\n    justify-content: center;\r\n}\r\n\r\n.left-img-container{\r\n    margin-left: 120px;\r\n    margin-top: 100px;\r\n    width: 400px;\r\n    height: 600px;\r\n    background-color: #ffffff;\r\n    float: left;\r\n    text-align: center;\r\n}\r\n\r\n.left-img-container .el-upload-dragger{\r\n    width: 400px;\r\n    height: 400px;\r\n    background-color: #f5f5f5;\r\n    border: #614555 2px;\r\n    border-radius: 5px;\r\n    border-style:dotted;\r\n    text-align: center;\r\n}\r\n\r\n.right-img-container{\r\n    margin-right: 120px;\r\n    margin-top: 100px;\r\n    width: 400px;\r\n    height: 600px;\r\n    background-color: #ffffff;\r\n    float: right;\r\n    text-align: center;\r\n\r\n}\r\n\r\n.right-img-container .el-upload-dragger{\r\n    width: 400px;\r\n    height: 400px;\r\n    background-color: #f5f5f5;\r\n    border: #614555 2px;\r\n    border-radius: 5px;\r\n    border-style:dotted;\r\n    text-align: center;\r\n}\r\n\r\n.mid-img-container{\r\n    margin-left: 132px;\r\n    margin-right: 132px;\r\n    width: 200px;\r\n    height: 200px;\r\n    background-color: #ffffff;\r\n    float: left;\r\n    border: #f5f5f5 1px;\r\n    border-radius: 5px;\r\n    text-align: center;\r\n}\r\n\r\n.mid-img-container > div{\r\n    width: 100%;\r\n    height: 100px;\r\n    background-color: #ffffff;\r\n    float: left;\r\n    text-align: center;\r\n}\r\n\r\n.img-button{\r\n    width: 400px;\r\n    height: 400px;\r\n    background-color: #f5f5f5;\r\n    border: #f5f5f5 1px;\r\n    border-radius: 5px;\r\n    display: flex;\r\n}\r\n.img-button .imgshow{\r\n    max-width: 390px;\r\n    max-height: 320px;\r\n    margin: 0 auto;\r\n}\r\n.imgshow img{\r\n    max-width: 390px;\r\n    max-height: 320px;\r\n    display: inline;\r\n    object-fit: fill;\r\n    margin: 0 auto;\r\n}\r\n.el-icon.avatar-uploader-icon {\r\n  font-size: 28px;\r\n  color: #8c939d;\r\n  width: 300px;\r\n  height: 300px;\r\n  text-align: center;\r\n}\r\n.dialog-center{\r\n    text-align: center;\r\n}\r\n.record-button{\r\n    margin-top: 5%;\r\n    width: 100%;\r\n    height: 100%;\r\n}\r\n}\r\n\r\n</style>\r\n\r\n\r\n"],"names":[],"mappings":"4gBA+FA"}